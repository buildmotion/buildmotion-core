!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/common"),require("buildmotion-foundation"),require("buildmotion-logging"),require("@angular/router"),require("rxjs/add/operator/filter"),require("angular-rules-engine")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","buildmotion-foundation","buildmotion-logging","@angular/router","rxjs/add/operator/filter","angular-rules-engine"],r):r(e.buildmotionCore={},e.ng.core,e.ng.common,e.buildmotionFoundation,e.buildmotionLogging,e.ng.router,null,e.angularRulesEngine)}(this,function(e,r,t,o,n,i,s,a){"use strict";var g=function(){function e(){}return e.Information="alert-info",e.Warning="alert-warning",e.Danger="alert-danger",e.Success="alert-success",e}(),l=function(){return function(e,r,t,o){this.type=g.Information,this.messages=new Array,this.showAlert=!1,o&&(this.type=o),this.header=e,this.title=r,t&&(this.messages=t),this.header&&this.title&&(this.showAlert=!0)}}(),u=function(){function e(){this.alertNotification=new l("",""),this.hasMessage=!1}return e.prototype.ngOnInit=function(){},e.decorators=[{type:r.Component,args:[{selector:"buildmotion-alert",template:'<div *ngIf="hasMessage">\n  <div class="alert {{alertNotification.type}} fade in">\n    \x3c!--<a href="#" class="close" data-dismiss="alert">&times;</a>--\x3e\n    <strong>{{alertNotification.header}}</strong> :: {{alertNotification.title}}\n    <ul>\n      <li *ngFor="let message of alertNotification.messages">{{message}}</li>\n    </ul>\n  </div>\n</div>'}]}],e.ctorParameters=function(){return[]},e.propDecorators={alertNotification:[{type:r.Input}],hasMessage:[{type:r.Input}]},e}(),c=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{imports:[t.CommonModule,o.BuildMotionFoundationModule,n.BuildMotionLoggingModule],declarations:[u],exports:[u],schemas:[r.NO_ERRORS_SCHEMA]}]}],e.ctorParameters=function(){return[]},e}(),f=function(){function e(e,r,t){this.loggingService=r,this.router=t,this.componentName=e,this.alertNotification=new l("","");var o=this.router.events.filter(function(e){return e instanceof i.NavigationEnd});o&&o instanceof i.NavigationEnd&&this.googleAnalyticsPageview(o)}return e.prototype.googleAnalyticsPageview=function(e){window.ga("set","page",e.urlAfterRedirects),window.ga("send","pageview")},e.prototype.createErrorResponse=function(e){this.loggingService.log(this.componentName,n.Severity.Information,"Preparing to create error response for component.");var r=new o.ErrorResponse;return r.Message=e,r},e.prototype.handleServiceErrors=function(e,r){if(this.loggingService.log(this.componentName,n.Severity.Information,"Preparing to handle service errors for component."),r&&r.hasErrors()){this.loggingService.log(this.componentName,n.Severity.Information,"Retrieving error messages from the ServiceContext/ValidationContext;");var t=this.retrieveServiceContextErrorMessages(r);this.alertNotification=new l("Errors",e.Message,t,g.Warning)}else if(e&&e.Message){this.loggingService.log(this.componentName,n.Severity.Information,"Retrieving error messages from the [ErrorResponse].");var o=this.retrieveResponseErrorMessages(e);this.alertNotification=new l("Error",e.Message,o,g.Warning),this.loggingService.log(this.componentName,n.Severity.Error,"Error: "+e.Message)}},e.prototype.retrieveServiceContextErrorMessages=function(e){var r=Array();return e.Messages.forEach(function(e){e.MessageType===a.MessageType.Error&&e.DisplayToUser&&r.push(e.Message)}),r},e.prototype.retrieveResponseErrorMessages=function(e){var r=new Array;return e&&e.Errors&&e.Errors.forEach(function(e){e.DisplayToUser&&r.push(e.Message)}),r},e.prototype.resetAlertNotifications=function(){this.alertNotification=new l("","")},e.prototype.routeTo=function(e){try{this.router.navigate([e])}catch(r){this.loggingService.log(this.componentName,n.Severity.Error,"Error while attempting to navigate to ["+e+"] route from "+this.componentName+". Error: "+r.toString())}},e.prototype.showResponseErrors=function(e){this.handleServiceErrors(e,void 0)},e.prototype.finishRequest=function(e){this.loggingService.log(this.componentName,n.Severity.Information,this.componentName+": "+e)},e.prototype.showAlertMessage=function(e){alert(e)},e}();e.BuildMotionCoreModule=c,e.AlertComponent=u,e.ComponentBase=f,Object.defineProperty(e,"__esModule",{value:!0})});